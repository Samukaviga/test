import{c as R,a as g,o as _,b as l,t as x,F as h,r as S,m as $,d as P,e as j,f as T,g as q,u as B,h as M,i as p,w as C,j as L,k as w,l as K,n as Y}from"./index-DlHKnVSg.js";import{_ as b,a as G,b as J}from"./Button-CZtbyjjd.js";import{u as W}from"./contactStore-DKJGLDgV.js";import{_ as z,C as H}from"./Card-M9LsZTJh.js";const Q={class:"relative"},X=["required","value"],Z={disabled:"",value:""},ee=["label"],te=["value"],ae=["value"],re=Object.assign({inheritAttrs:!1},{__name:"Select",props:{required:{type:Boolean,default:!1},placeholder:{type:String,default:"Selecione..."},modelValue:String,options:{type:[Array,Object],default:()=>[]}},emits:["update:modelValue"],setup(a){const e=a,r=R(()=>Array.isArray(e.options)&&e.options.length>0&&e.options[0].options!==void 0);return(o,d)=>(_(),g("div",Q,[l("select",$({required:a.required,value:a.modelValue,onChange:d[0]||(d[0]=s=>o.$emit("update:modelValue",s.target.value))},o.$attrs,{class:"w-full appearance-none px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-300 transition pr-10"}),[l("option",Z,x(a.placeholder),1),r.value?(_(!0),g(h,{key:0},S(a.options,s=>(_(),g("optgroup",{key:s.label,label:s.label},[(_(!0),g(h,null,S(s.options,v=>(_(),g("option",{key:v.value,value:v.value},x(v.label),9,te))),128))],8,ee))),128)):(_(!0),g(h,{key:1},S(a.options,s=>(_(),g("option",{key:s,value:s},x(s),9,ae))),128))],16,X),d[1]||(d[1]=l("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[l("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 9l-7 7-7-7"})])],-1))]))}}),V="utm:first",I="utm:last",oe=90;function U(){return new Date().toISOString()}function ie(a){if(!a)return!0;const e=new Date(a);return Date.now()-e.getTime()>oe*24*60*60*1e3}function A(a){try{const e=localStorage.getItem(a);if(!e)return null;const r=JSON.parse(e);return ie(r?.timestamp)?(localStorage.removeItem(a),null):r}catch{return null}}function E(a,e){localStorage.setItem(a,JSON.stringify({...e,timestamp:U()}))}function ne(){const a=new URLSearchParams(window.location.search),e={};return["utm_source","utm_medium","utm_campaign","utm_term","utm_content","gclid","fbclid","msclkid"].forEach(o=>{const d=a.get(o);d&&(e[o]=d)}),e.referrer=document.referrer||void 0,e.landing_page=window.location.href,e}function se(a){const e=(a?.utm_source||"").toLowerCase(),r=(a?.utm_medium||"").toLowerCase(),o=(a?.referrer||"").toLowerCase();return e.includes("google")||a?.gclid?"google_ads":e.includes("facebook")||e.includes("fb")||a?.fbclid?"facebook_ads":e.includes("instagram")?"instagram":e.includes("bing")||e.includes("msclkid")?"bing_ads":e.includes("tiktok")?"tiktok":e.includes("linkedin")?"linkedin":r==="email"||e.includes("mail")?"email":r==="cpc"||r==="paid"||r==="ppc"?"paid_search":e==="direct"||!a?.utm_source&&!o?"direct":o.includes("google.")?"google_organic":o.includes("bing.")?"bing_organic":o.includes("facebook.")?"facebook_organic":o.includes("instagram.")?"instagram_organic":e||void 0}function le(){function a(){const o=ne(),d=Object.keys(o).length>2,s=A(V);!s&&d&&E(V,o),d?E(I,o):s||E(V,{referrer:document.referrer||void 0,landing_page:window.location.href,timestamp:U()})}function e(){return A(V)}function r(){return A(I)}return{captureFromUrl:a,getFirst:e,getLast:r,toLeadSource:se}}const de=P({__name:"FormRegister",setup(a){const{captureFromUrl:e,getFirst:r,getLast:o,toLeadSource:d}=le();j(()=>{e()});const s=[{etapa:"Educação Infantil",series:[{serie:"Menor de 1 ano",idade:1,obrigatoria:!1},{serie:"Pré-Escola - 2 anos",idade:2,obrigatoria:!1},{serie:"Pré-Escola - 3 anos",idade:3,obrigatoria:!1},{serie:"Pré-Escola - 4 anos",idade:4,obrigatoria:!0},{serie:"Pré-Escola - 5 anos",idade:5,obrigatoria:!0}]},{etapa:"Ensino Fundamental",series:[{serie:"1º ano",idade:6,obrigatoria:!0},{serie:"2º ano",idade:7,obrigatoria:!0},{serie:"3º ano",idade:8,obrigatoria:!0},{serie:"4º ano",idade:9,obrigatoria:!0},{serie:"5º ano",idade:10,obrigatoria:!0},{serie:"6º ano",idade:11,obrigatoria:!0},{serie:"7º ano",idade:12,obrigatoria:!0},{serie:"8º ano",idade:13,obrigatoria:!0},{serie:"9º ano",idade:14,obrigatoria:!0}]},{etapa:"Ensino Médio",series:[{serie:"1ª série",idade:15,obrigatoria:!0},{serie:"2ª série",idade:16,obrigatoria:!0},{serie:"3ª série",idade:17,obrigatoria:!0}]}];function v(){return s.map(m=>({label:m.etapa,options:m.series.map(t=>({label:`${t.serie}`,value:t.serie}))}))}const u=o()||{},c=r()||{},D=d(u)||d(c)||"direct",i=T({responsible_name:"",student_name:"",indicated_responsible_name:"",indicated_student_name:"",indicated_mobile_phone:"",indicated_email:"",indicated_date_of_birth:"",indicated_education_level:"",lead_source:D,utm_source:u.utm_source??c.utm_source,utm_medium:u.utm_medium??c.utm_medium,utm_campaign:u.utm_campaign??c.utm_campaign,utm_term:u.utm_term??c.utm_term,utm_content:u.utm_content??c.utm_content,gclid:u.gclid??c.gclid,fbclid:u.fbclid??c.fbclid,msclkid:u.msclkid??c.msclkid,referrer:u.referrer??c.referrer,landing_page:u.landing_page??c.landing_page}),f=q({}),y=q(!1),O=B(),F="https://application.colegioitaqua.com.br";async function N(){try{y.value=!0;const m=await J.post(`${F}/api/registrations/`,i);W(m.data.data.id).setContact(m.data.data),O.push(`/sucesso/${m.data.data.id}`)}catch(m){y.value=!1,alert("Oops! Encontramos um erro inesperado. Por favor, tente novamente."),m.response&&m.response.status===422&&(f.value=Object.fromEntries(Object.entries(m.response.data.errors).map(([t,k])=>[t,k[0]])))}}return(m,t)=>{const k=M("mask");return _(),g("form",{class:"flex flex-col gap-3 w-full",onSubmit:K(N,["prevent"])},[t[8]||(t[8]=l("span",{class:"text-gray-700 font-medium mt-0.5"},"Dados do Aluno",-1)),p(b,{modelValue:i.student_name,"onUpdate:modelValue":t[0]||(t[0]=n=>i.student_name=n),placeholder:"Nome do Aluno",required:"","aria-label":"Nome do Aluno",error:f.value.student_name},null,8,["modelValue","error"]),p(b,{modelValue:i.responsible_name,"onUpdate:modelValue":t[1]||(t[1]=n=>i.responsible_name=n),placeholder:"Nome do Responsavel",required:"","aria-label":"Nome do Responsavel",error:f.value.responsible_name},null,8,["modelValue","error"]),t[9]||(t[9]=l("span",{class:"text-gray-700 font-medium mt-0.5"},"Dados do aluno indicado",-1)),p(b,{required:"",name:"indicated_student_name",modelValue:i.indicated_student_name,"onUpdate:modelValue":t[2]||(t[2]=n=>i.indicated_student_name=n),placeholder:"Nome do aluno Indicado",error:f.value.indicated_student_name},null,8,["modelValue","error"]),p(b,{required:"",name:"indicated_responsible_name",modelValue:i.indicated_responsible_name,"onUpdate:modelValue":t[3]||(t[3]=n=>i.indicated_responsible_name=n),placeholder:"Responsavel do aluno Indicado",error:f.value.indicated_responsible_name},null,8,["modelValue","error"]),C(p(b,{modelValue:i.indicated_mobile_phone,"onUpdate:modelValue":t[4]||(t[4]=n=>i.indicated_mobile_phone=n),type:"tel",placeholder:"WhatsApp / Celular do Aluno Indicado",required:"","aria-label":"WhatsApp",error:f.value.indicated_mobile_phone},null,8,["modelValue","error"]),[[k,"(##) #####-####"]]),p(b,{modelValue:i.indicated_email,"onUpdate:modelValue":t[5]||(t[5]=n=>i.indicated_email=n),type:"email",placeholder:"E-mail do Aluno Indicado",required:"","aria-label":"E-mail",error:f.value.indicated_email},null,8,["modelValue","error"]),C(p(b,{modelValue:i.indicated_date_of_birth,"onUpdate:modelValue":t[6]||(t[6]=n=>i.indicated_date_of_birth=n),type:"tel",placeholder:"Data de nascimento do Aluno indicado","aria-label":"Data de nascimento",error:f.value.indicated_date_of_birth},null,8,["modelValue","error"]),[[k,"##/##/####"]]),p(re,{modelValue:i.indicated_education_level,"onUpdate:modelValue":t[7]||(t[7]=n=>i.indicated_education_level=n),placeholder:"Série Atual",options:v(),error:f.value.indicated_education_level},null,8,["modelValue","options","error"]),t[10]||(t[10]=l("div",{class:"flex items-start gap-2 text-sm"},[l("input",{id:"aceito-termos",type:"checkbox",required:"",class:"mt-1 accent-blue-800"}),l("label",{for:"aceito-termos",class:"select-none"}," Li e aceito os Termos do Regulamento. ")],-1)),p(G,{type:"submit",disabled:y.value},{default:L(()=>[w(x(y.value?"Salvando...":"Confirmar"),1)]),_:1},8,["disabled"])],32)}}}),fe={__name:"Register",setup(a){return(e,r)=>(_(),Y(z,null,{default:L(()=>[p(H,{class:"max-w-md w-full"},{default:L(()=>[r[0]||(r[0]=l("h2",{class:"text-2xl font-bold text-gray-800 mb-3 text-center"},"Indique um amigo!",-1)),r[1]||(r[1]=l("p",{class:"text-sm text-gray-600 text-center mb-6"},[w(" Preencha todos os campos abaixo para "),l("br"),w(" concorrer a um "),l("span",{class:"font-bold text-blue-900"},"Desconto de até 100%, Alexa, Table e um Kit uniforme"),w(". ")],-1)),p(de)]),_:1,__:[0,1]})]),_:1}))}};export{fe as default};
